# Call Dockerfile
- template:
    src: Dockerfile.j2
    dest: /tmp/Dockerfile
    mode: 0644
    owner: root
    group: root

- name: Build Docker file
  shell: docker build -t nginx:latest .
  args:
    chdir: /tmp/

# Login Docker hub
- name: Log into DockerHub
  docker_login:
    username: prateeksw05
    password: pass1234
    reauthorize: yes

- name: Running the container
  docker_container:
    image: nginx:latest
    name: nginx
    state: started

- name: Push image into dokcer hub
  docker_image:
    name: nginx
    repository: prateeksw05/nginx:latest
    push: yes
